Sub FormatAndGroupSheet()

    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    
    Dim Cb As Long ' Balance forward row
    Dim Ct As Long ' Totals for row
    
    Set ws = ActiveSheet
    
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    
    '----------------------------------------
    ' Freeze panes at row 8
    '----------------------------------------
    ws.Activate
    ws.Range("A9").Select   ' Freeze above row 9 = freeze at row 8
    ActiveWindow.FreezePanes = True
    
    '----------------------------------------
    ' Determine last used row in column A
    '----------------------------------------
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    
    ' Clear existing outlines to avoid conflicts
    ws.Rows.ClearOutline
    
    Cb = 0
    Ct = 0
    
    '----------------------------------------
    ' Loop through column A
    '----------------------------------------
    For i = 1 To lastRow
        
        If InStr(1, ws.Cells(i, "A").Value, "(Balance forward", vbTextCompare) > 0 Then
            Cb = i
        End If
        
        If InStr(1, ws.Cells(i, "A").Value, "Totals for", vbTextCompare) > 0 Then
            Ct = i
        End If
        
        ' When both markers are found, group rows
        If Cb > 0 And Ct > 0 And Ct > Cb + 1 Then
            
            ws.Rows(Cb + 1 & ":" & Ct - 1).Group
            
            ' Reset markers to find next instance
            Cb = 0
            Ct = 0
            
        End If
        
    Next i
    
    Application.ScreenUpdating = True
    Application.EnableEvents = True

End Sub
